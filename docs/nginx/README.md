---
title: "介绍"
---

# 什么是 Nginx

中间件的作用是隔离应用与应用，应用与操作系统，层次分明，让应用专注于业务。而 Nginx 就是一个开源且高性能、可靠的 HTTP 中间件、代理服务。

## 常见的中间件服务

- HTTPD: apache 基金会的产品
- IIS: 微软
- GWS: google web server

## 为什么选择 nginx?

**1、IO 多路复用 epoll(单线程异步 IO)**

为了解决并发的问题，可以采用的方案有多线程、IO 多路复用。多线程存在资源消耗的问题。IO 多路复用就是单线程异步 IO，响应会主动上报(内核会主动发送文件信息给应用端)。

IO 多路复用的实现方式：select、poll、epoll。

- `select`: 是单线程同步的方式，效率低下，而且能够监听文件描述符的数量存在最大限制 1024 个。
- `epoll`: 是单线程异步的方式，最大连接无限制。

**2、轻量级**

- 功能模块少，只保留了和 http 核心相关的代码。
- 代码模块化

**3、CPU 亲和**

多核服务器主要用于多线程，密集计算型服务使用。如果有多个 CPU，利用它自动的切换工作方式，会造成性能的损耗。

Nginx 是将工作进程和 CPU 核心，也就是把每个 worker 进程固定到一个 CPU 上执行，减少切换 CPU 的 cache miss，获得更好的性能。

![](./1/nginx.png)

**4、sendfile**

nginx 处理静态资源服务是非常高效的。

请求文件时，会经过操作系统的`内核空间 -> 用户空间 -> 内核空间 -> Socket`多次切换后返回给用户。但是静态文件的获取时可以在内核空间直接返回，不需要用户空间的逻辑处理。nginx 是采用了 linux2 的零拷贝传输模式，把文件的传输只通过内核空间传给 Socket，返回给用户。所以在 CBN、或动静分离的静态文件处理上，性能更优。

![](./1/2.png)
