(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{199:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",function(){return r}),n.d(t,"rightToc",function(){return c}),n.d(t,"default",function(){return p});n(0);var a=n(293);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var r={title:"javascript 编码知识",sidebar_label:"编码知识"},c=[{value:"字符编码历史",id:"字符编码历史",children:[]},{value:"URI 编解码",id:"uri-编解码",children:[{value:"encodeURI 和 encodeURIComponent",id:"encodeuri-和-encodeuricomponent",children:[]}]},{value:"base64编解码",id:"base64编解码",children:[]},{value:"学习资料",id:"学习资料",children:[]}],b={rightToc:c},i="wrapper";function p(e){var t=e.components,n=l(e,["components"]);return Object(a.b)(i,o({},b,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"看了一些字符编码的文章，东西太多，但是只需要知道几个重点就可以了。"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"字符编码的发展历史"),Object(a.b)("li",{parentName:"ul"},"unicode编码：utf16和utf8"),Object(a.b)("li",{parentName:"ul"},"url编码"),Object(a.b)("li",{parentName:"ul"},"base64编码原理")),Object(a.b)("h2",{id:"字符编码历史"},"字符编码历史"),Object(a.b)("p",null,"最早外国人发明电脑的时候为了处理字符，普遍是用8位来存储的，因为他们只有","[0-9a-zA-Z]","和其它标点符号、指令等，所以7位就完全够了，留一位用做通讯系统的奇偶验证。这叫做ASCII编码，有 127 个字符。"),Object(a.b)("p",null,"后来一些国家想在剩余的1位里加一些其它的字符，如重音、下划线等，这叫OEM字符集。但每个国家都不一样，所以128-256这段字符在每个机器可能都不一样。"),Object(a.b)("p",null,"另外一些亚洲国家也要用电脑，如中国，光汉字就可能上万个。8位不够存，于是有些人就用2个字节来存储，这叫做MBCS(多字节字符集)或中文字符集，有GBK、GB2312之类。"),Object(a.b)("p",null,"这么多不同的字符集让文档交流很困难，所以各种组织开始指定规范，有ANSI标准(美国)、国家标准、ISO标准(如中国GBK等)等。"),Object(a.b)("p",null,"虽然可以在一台机器上查不同语言的文档，但是无法在文档中显示所有字符。所以最后出现了Unicode字符串，涵盖人类所有的字符。它按使用频繁度分成17个层面，每个层有2^16 = 65536 个字符码空间。其中第0个层面BMP，基本涵盖了当今世界用到的所有字符。"),Object(a.b)("p",null,"之前的编码都是字符集和字符编码在一起，查表就行了。unicode将它们分开以利于扩展，即根据字符集找到的字符编码决定字符。"),Object(a.b)("p",null,"ucs-2:只考虑了BMP字符，使用固定2个字节长度。\nutf16:最少2个字节，BMP之外的字符用4个字节。对于单字节字符处理性能低些。因为单字节前面都是0x00，浪费了。\nutf8: 应用最广，多字节的解析是根据首字节的前置，如果是1110yyy，表示字符解析成3个字节，剩余每个字节都是10开头。"),Object(a.b)("h2",{id:"uri-编解码"},"URI 编解码"),Object(a.b)("p",null,"一个 URI 可能包含下面五种字符："),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"保留字符：",Object(a.b)("inlineCode",{parentName:"li"},"; / ? : @ & = + $")),Object(a.b)("li",{parentName:"ol"},"非转义字符：",Object(a.b)("inlineCode",{parentName:"li"},"[a-zA-Z0-9]"),"和 uri 标记符 ",Object(a.b)("inlineCode",{parentName:"li"},"- _ . ! ~ * ' ( )")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("inlineCode",{parentName:"li"},"#")),Object(a.b)("li",{parentName:"ol"},"其它字符，即非上面的字符。"),Object(a.b)("li",{parentName:"ol"},"被转义字符",Object(a.b)("inlineCode",{parentName:"li"},"%xx"),"，是十六进制")),Object(a.b)("h3",{id:"encodeuri-和-encodeuricomponent"},"encodeURI 和 encodeURIComponent"),Object(a.b)("p",null,"encodeURI 遇到上面的",Object(a.b)("inlineCode",{parentName:"p"},"4.其它字符"),"时会转义。encodeURIComponent 遇到",Object(a.b)("inlineCode",{parentName:"p"},"1、3、4"),"时会转义，通常用来做 url 参数 k=v 的编解码。"),Object(a.b)("pre",null,Object(a.b)("code",o({parentName:"pre"},{className:"language-js"}),"encodeURI('%')   // '%25'\nencodeURIComponent('%') // '%25'\n\nencodeURI('?')   // '?'\nencodeURIComponent('?') // \"%3F\"\n\nencodeURI('https://banli17.com/blog/?a=1#h=2')\n// \"https://banli17.com/blog/?a=1#h=2\"\nencodeURIComponent('https://banli17.com/blog/?a=1#h=2')\n// \"https%3A%2F%2Fbanli17.com%2Fblog%2F%3Fa%3D1%23h%3D2\"\n")),Object(a.b)("h2",{id:"base64编解码"},"base64编解码"),Object(a.b)("p",null,"Base64编码要求把3个8位字节（3",Object(a.b)("em",{parentName:"p"},"8=24）转化为4个6位的字节（4"),"6=24），之后在6位的前面补两个0，形成8位一个字节的形式。 如果剩下的字符不足3个字节，则用0填充，输出字符使用‘=’，因此编码后输出的文本末尾可能会出现1或2个‘=’。"),Object(a.b)("p",null,"关于这个编码的规则："),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"把3个字符变成4个字符。"),Object(a.b)("li",{parentName:"ol"},"每76个字符加一个换行符。"),Object(a.b)("li",{parentName:"ol"},"最后的结束符也要处理。")),Object(a.b)("pre",null,Object(a.b)("code",o({parentName:"pre"},{className:"language-js"}),"const buf1 = Buffer.from('我')\nconsole.log(buf1) // <Buffer e6 88 91>\n\n// 1) 将 3*8 拆成 4*6\nconsole.log(0xe6.toString(2)) // 11100110\nconsole.log(0x88.toString(2)) // 10001000\nconsole.log(0x91.toString(2)) // 10010001\n\n// 11100110 - 10001000 - 10010001 - >\n// 111001 - 101000 - 100010 - 010001 - >\n// 00111001 - 00101000 - 00100010 - 00010001\n\n// 2) 转为10进制\nconsole.log(parseInt('00111001', 2)) // 57\nconsole.log(parseInt('00101000', 2)) // 40\nconsole.log(parseInt('00100010', 2)) // 34\nconsole.log(parseInt('00010001', 2)) // 17\n\n// 3) 对应到数组\nconst base64 =  'abcdefghijklmnopqrstuvwxyz'.toUpperCase() + 'abcdefghijklmnopqrstuvwxyz' + '0123456789+/'\n\nconst str = base64[57] + base64[40] + base64[34] + base64[17] \nconsole.log(str) // 5oiR\nconsole.log(buf1.toString('base64'))  //5oi\n")),Object(a.b)("p",null,"可以看到转 base64 后，3 个字节变成了 4个(即每 3 个字节增加 1 个字节)，所以大小会增大 1/3 左右。"),Object(a.b)("p",null,"图片的base64编码。"),Object(a.b)("h2",{id:"学习资料"},"学习资料"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html"}),"字符编码笔记：ASCII，Unicode 和 UTF-8")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"http://www.ruanyifeng.com/blog/2014/12/unicode.html"}),"Unicode与JavaScript详解")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"http://www.ruanyifeng.com/blog/2008/06/base64.html"}),"Base64笔记 ")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://www.zhihu.com/question/23374078"}),"Unicode 和 UTF-8 有何区别？")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://stackoverflow.com/questions/7381974/which-characters-need-to-be-escaped-on-html"}),"哪些字符需要在HTML中转义？")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://www.zhihu.com/question/36306744"}),"为什么要使用base64编码，有哪些情景需求？")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://www.zhihu.com/question/30987792"}),"UTF-8与其他编码比较，它劣势在哪？")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"http://www.ruanyifeng.com/blog/2010/02/url_encoding.html"}),"关于URL编码"),Object(a.b)("a",o({parentName:"li"},{href:"https://www.cnblogs.com/luguo3000/p/3627027.html"}),"https://www.cnblogs.com/luguo3000/p/3627027.html")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"http://imweb.io/topic/57024e4606f2400432c1396d"}),"从零开始学web安全（3）")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://blog.csdn.net/mr_pang/article/details/47060087"}),"https://blog.csdn.net/mr_pang/article/details/47060087")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://www.cnblogs.com/jerrysion/p/5522673.html"}),"为什么要进行URL编码")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"http://www.imkevinyang.com/2010/06/%E5%85%B3%E4%BA%8E%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%EF%BC%8C%E4%BD%A0%E6%89%80%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84.html"}),"关于字符编码，你所需要知道的")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://en.wikipedia.org/wiki/Character_encoding"}),"wiki character encoding")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://github.com/jagracey/Awesome-Unicode"}),"https://github.com/jagracey/Awesome-Unicode")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://github.com/Codepoints/awesome-codepoints"}),"https://github.com/Codepoints/awesome-codepoints")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",o({parentName:"li"},{href:"https://www.zhihu.com/question/21861899"}),"escape,encodeURI,encodeURIComponent有什么区别?"))))}p.isMDXComponent=!0},293:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u});var a=n(0),o=n.n(a),l=o.a.createContext({}),r=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):Object.assign({},t,e)),n},c=function(e){var t=r(e.components);return o.a.createElement(l.Provider,{value:t},e.children)};var b="mdxType",i={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},p=function(e){var t=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,c=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(n[a]=e[a]);return n}(e,["components","mdxType","originalType","parentName"]),b=r(t),p=n,u=b[l+"."+p]||b[p]||i[p]||a;return t?o.a.createElement(u,Object.assign({},c,{components:t})):o.a.createElement(u,c)};function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,r=new Array(l);r[0]=p;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c[b]="string"==typeof e?e:a,r[1]=c;for(var u=2;u<l;u++)r[u]=n[u];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"}}]);