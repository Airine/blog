(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{175:function(e,a,n){"use strict";n.r(a),n.d(a,"frontMatter",function(){return c}),n.d(a,"rightToc",function(){return l}),n.d(a,"default",function(){return p});n(0);var t=n(217);function r(){return(r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function i(e,a){if(null==e)return{};var n,t,r=function(e,a){if(null==e)return{};var n,t,r={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c={title:"ReactNative商业项目经验集",date:new Date("2018-12-20T23:41:00.000Z"),toc:!0},l=[{value:"app预览",id:"app预览",children:[]},{value:"简介",id:"简介",children:[]},{value:"调试",id:"调试",children:[]},{value:"mac 开发环境搭建",id:"mac-开发环境搭建",children:[{value:"安装node, watchman",id:"安装node-watchman",children:[]},{value:"安装react-native-cli",id:"安装react-native-cli",children:[]},{value:"xcode",id:"xcode",children:[]},{value:"虚拟机的安装",id:"虚拟机的安装",children:[]},{value:"下载Android Studio，并且安装sdk",id:"下载android-studio，并且安装sdk",children:[]},{value:"一些命令",id:"一些命令",children:[]},{value:"如何运行iso的虚拟机",id:"如何运行iso的虚拟机",children:[]}]},{value:"解决react-native run-android报DeviceException Could not create ADB Bridge错误",id:"解决react-native-run-android报deviceexception-could-not-create-adb-bridge错误",children:[]},{value:"安装genymotion模拟器步骤",id:"安装genymotion模拟器步骤",children:[]},{value:"安装apk",id:"安装apk",children:[]},{value:"真机调试",id:"真机调试",children:[]},{value:"参考资料",id:"参考资料",children:[]}],b={rightToc:l},o="wrapper";function p(e){var a=e.components,n=i(e,["components"]);return Object(t.b)(o,r({},b,n,{components:a,mdxType:"MDXLayout"}),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"app预览"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#app预览"}),"#"),"app预览"),Object(t.b)("p",null,Object(t.b)("img",r({parentName:"p"},{src:"./index/1.png",alt:null}))),Object(t.b)("p",null,"下载页面判断了手机平台，iphone出现ios下载按钮，android手机出现android下载按钮。"),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"简介"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#简介"}),"#"),"简介"),Object(t.b)("p",null,"本项目是我们团队开发rn app过程中遇到的问题和解决方案总结。个人感觉如果要做体验很好的app，就不要使用rn了，因为成本较高。像动画、性能这块比较难以处理。没有大神实在是无能为力。另外实现一些比较复杂的原生需求，没有懂",Object(t.b)("inlineCode",{parentName:"p"},"android"),"、",Object(t.b)("inlineCode",{parentName:"p"},"ios"),"的人在场很难实现。"),Object(t.b)("p",null,"app 功能列表如下: "),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"大量的表单")," ","[已完成，需要改进]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"拍照上传图片，身份证、营业执照、银行卡等自动识别")," ","[已完成]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"商城")," ","[目前是用的之前的h5商城，即将重新开发成rn]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"app自动更新")," ","[支持热更新/硬更新]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"app连接蓝牙打印机打印小票")," ","[已完成]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"二维码生成和扫描识别")," ","[已完成]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"微信登陆、分享、支付")," ","[已完成]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"火车票功能，和12306类似")," ","[基本完成，剩下抢票功能]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"聊天：和微信一样")," ","[正在进行中...]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"推送")," ","[功能已完成，应用中]"),Object(t.b)("li",{parentName:"ul"},Object(t.b)("strong",{parentName:"li"},"强大的webview库，支持微信h5支付、下载、上传图片视频等")," ","[即将完成]")),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"调试"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#调试"}),"#"),"调试"),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{}),'open "rndebugger://set-debugger-loc?host=localhost&port=8081"\n')),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"mac-开发环境搭建"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#mac-开发环境搭建"}),"#"),"mac 开发环境搭建"),Object(t.b)("h3",null,Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"anchor",id:"安装node-watchman"})),Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"hash-link",href:"#安装node-watchman"}),"#"),"安装node, watchman"),Object(t.b)("p",null,"推荐使用brew工具进行安装，安装brew的命令如下："),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{}),'/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"\n')),Object(t.b)("p",null,"然后执行下面的命令，安装node和watchman"),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{className:"language-bash"}),"brew install node\nbrew install watchman\n")),Object(t.b)("p",null,"watchman是facebook发布的一个用来监视文件变动的工具。"),Object(t.b)("h3",null,Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"anchor",id:"安装react-native-cli"})),Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"hash-link",href:"#安装react-native-cli"}),"#"),"安装react-native-cli"),Object(t.b)("p",null,"react-native-cli可以用来运行react-native的相关命令。"),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{}),"npm install -g react-native-cli\n")),Object(t.b)("p",null,"如果发生权限错误，可以执行："),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{className:"language-bash"}),"sudo npm install -g react-native-cli\n")),Object(t.b)("p",null,'如果报 "cannot find module npmlog"，直接运行下面命令安装npm：'),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{className:"language-bash"}),"curl -0 -L http://npmjs.org/install.sh | sudo sh.\n")),Object(t.b)("h3",null,Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"anchor",id:"xcode"})),Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"hash-link",href:"#xcode"}),"#"),"xcode"),Object(t.b)("p",null,"安装xcode最简单的方法是在苹果商店安装。"),Object(t.b)("h3",null,Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"anchor",id:"虚拟机的安装"})),Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"hash-link",href:"#虚拟机的安装"}),"#"),"虚拟机的安装"),Object(t.b)("p",null,"安装virtualbox 和genymotion\n",Object(t.b)("a",r({parentName:"p"},{href:"https://www.virtualbox.org/wiki/Downloads"}),"https://www.virtualbox.org/wiki/Downloads"),"\n",Object(t.b)("a",r({parentName:"p"},{href:"https://dl.genymotion.com/releases/genymotion-2.8.0/genymotion-2.8.0.dmg"}),"https://dl.genymotion.com/releases/genymotion-2.8.0/genymotion-2.8.0.dmg"),"\n安装sdk\n让虚拟机能够安装apk文件的方法：",Object(t.b)("a",r({parentName:"p"},{href:"https://forum.xda-developers.com/showthread.php?t=2528952"}),"https://forum.xda-developers.com/showthread.php?t=2528952")),Object(t.b)("h3",null,Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"anchor",id:"下载android-studio，并且安装sdk"})),Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"hash-link",href:"#下载android-studio，并且安装sdk"}),"#"),"下载Android Studio，并且安装sdk"),Object(t.b)("p",null,"react-native-android-studio-android-sdk-build-tools.png\nreact-native-android-studio-android-sdk-platforms.png\n并且在genymotion中设置sdk的路径，否则可能会报错'",Object(t.b)("em",{parentName:"p"}," failed to start daemon ")," error: cannot connect to daemon'\n测试安装"),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{className:"language-bash"}),"react-native init AwesomeProject\ncd AwesomeProject\nreact-native run-android\n")),Object(t.b)("p",null,"遇到要下载gradle-2.4-all.zip，可以去 ",Object(t.b)("a",r({parentName:"p"},{href:"https://services.gradle.org/distributions/gradle-2.4-all.zip"}),"https://services.gradle.org/distributions/gradle-2.4-all.zip")," 下载之后，放在目录 User/banli/.gradle/wrapper/dists/gradle-2.4-all/6r4uqcc6ovnq6ac6s0txzcpc0下面"),Object(t.b)("h3",null,Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"anchor",id:"一些命令"})),Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"hash-link",href:"#一些命令"}),"#"),"一些命令"),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{}),"mv software/reactnative/gradle-2.4-all.zip .gradle/wrapper/dists/gradle-2.4-all/\ncd .gradle/wrapper/dists/gradle-2.4-all/\nls\nunzip gradle-2.4-all.zip\nhistory\ncp -r 拷贝\n")),Object(t.b)("h3",null,Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"anchor",id:"如何运行iso的虚拟机"})),Object(t.b)("a",r({parentName:"h3"},{"aria-hidden":!0,className:"hash-link",href:"#如何运行iso的虚拟机"}),"#"),"如何运行iso的虚拟机"),Object(t.b)("p",null,"打开xCode然后打开ios/xxx.xcodeproj 然后，点击运行按钮。就可以启动了。"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"android")),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{}),"git clone https://github.com/facebook/react-native.git\n./gradlew :Examples:UIExplorer:android:app:installDebug\n")),Object(t.b)("p",null,"参考文章：",Object(t.b)("a",r({parentName:"p"},{href:"http://www.jianshu.com/p/bcaaf51a9d0b"}),"http://www.jianshu.com/p/bcaaf51a9d0b")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"iso")),Object(t.b)("p",null,"启动xcode，然后启动项目中的",Object(t.b)("inlineCode",{parentName:"p"},"uiexplorer.xcodeproj"),"即可。要首先",Object(t.b)("inlineCode",{parentName:"p"},"npm install"),"一下。"),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"解决react-native-run-android报deviceexception-could-not-create-adb-bridge错误"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#解决react-native-run-android报deviceexception-could-not-create-adb-bridge错误"}),"#"),"解决react-native run-android报DeviceException Could not create ADB Bridge错误"),Object(t.b)("p",null,"修改",Object(t.b)("inlineCode",{parentName:"p"},"genymotion"),"的 sdk，在：",Object(t.b)("inlineCode",{parentName:"p"},"settings -> ADB -> Use custom SDK tools"),"。"),Object(t.b)("h1",null,Object(t.b)("a",r({parentName:"h1"},{"aria-hidden":!0,className:"anchor",id:"genymotion安卓模拟器"})),Object(t.b)("a",r({parentName:"h1"},{"aria-hidden":!0,className:"hash-link",href:"#genymotion安卓模拟器"}),"#"),"genymotion安卓模拟器"),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"安装genymotion模拟器步骤"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#安装genymotion模拟器步骤"}),"#"),"安装genymotion模拟器步骤"),Object(t.b)("p",null,"1、注册账号并安装 genymotion 个人免费版。\n2、安装",Object(t.b)("inlineCode",{parentName:"p"},"virtualBox"),"。\n3、安装",Object(t.b)("inlineCode",{parentName:"p"},"android sdk"),"。\n4、修改",Object(t.b)("inlineCode",{parentName:"p"},"genymotion"),"的 setting 里的ADB的 android sdk。"),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"安装apk"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#安装apk"}),"#"),"安装apk"),Object(t.b)("p",null,Object(t.b)("inlineCode",{parentName:"p"},"genymotion"),"安装",Object(t.b)("inlineCode",{parentName:"p"},"apk"),"，需要首先安装 Genymotion_ARM_Translation 兼容包。"),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{className:"language-markup"}),"5.0.0以下链接: https://pan.baidu.com/s/1eSmu8H8 密码: dw7s\n5.0.0以上链接: https://pan.baidu.com/s/1o8fYEro 密码: hcgf\n")),Object(t.b)("p",null,"下载完后，直接将",Object(t.b)("inlineCode",{parentName:"p"},"zip"),"包拖入到模拟器中，安装完成后，重启模拟器，再安装",Object(t.b)("inlineCode",{parentName:"p"},"apk"),"即可(将apk拖入到模拟器中)。"),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"真机调试"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#真机调试"}),"#"),"真机调试"),Object(t.b)("p",null,"修改项目下",Object(t.b)("inlineCode",{parentName:"p"},"library -> RCTWebSocket.codeproj -> RCTWebSocetExecutor.m"),"中的代码："),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{}),'// 将localhost改为本机ip\nNSString *host = [[_bridge bundleURL] host] ?: @"192.168.0.104";\n// NSString *host = [[_bridge bundleURL] host] ?: @"localhost";\n')),Object(t.b)("p",null,"如果报错",Object(t.b)("inlineCode",{parentName:"p"},".. busy"),"则重插",Object(t.b)("inlineCode",{parentName:"p"},"usb"),"，重启",Object(t.b)("inlineCode",{parentName:"p"},"xcode"),"或重启手机。"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},'"Error: fsevents unavailable" on jest --watch')),Object(t.b)("pre",null,Object(t.b)("code",r({parentName:"pre"},{className:"language-bash"}),"npm r -g watchman\nbrew install watchman\n")),Object(t.b)("p",null,"然后，重开",Object(t.b)("inlineCode",{parentName:"p"},"js bundle"),"命令行。"),Object(t.b)("h2",null,Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"anchor",id:"参考资料"})),Object(t.b)("a",r({parentName:"h2"},{"aria-hidden":!0,className:"hash-link",href:"#参考资料"}),"#"),"参考资料"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",r({parentName:"li"},{href:"http://blog.csdn.net/mobilexu/article/details/50597174"}),"http://blog.csdn.net/mobilexu/article/details/50597174")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",r({parentName:"li"},{href:"https://blog.csdn.net/xiangzhihong8/article/details/54425807"}),"深入理解React Native页面构建渲染原理")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",r({parentName:"li"},{href:"https://cloud.tencent.com/developer/article/1036325"}),"React Native运行原理解析")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",r({parentName:"li"},{href:"https://github.com/facebook/react-native/issues/3082"}),"https://github.com/facebook/react-native/issues/3082")),Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",r({parentName:"li"},{href:"https://github.com/facebook/react-native/issues/1113"}),"https://github.com/facebook/react-native/issues/1113"))))}p.isMDXComponent=!0},217:function(e,a,n){"use strict";n.d(a,"a",function(){return l}),n.d(a,"b",function(){return d});var t=n(0),r=n.n(t),i=r.a.createContext({}),c=function(e){var a=r.a.useContext(i),n=a;return e&&(n="function"==typeof e?e(a):Object.assign({},a,e)),n},l=function(e){var a=c(e.components);return r.a.createElement(i.Provider,{value:a},e.children)},b="mdxType",o={inlineCode:"code",wrapper:function(e){return r.a.createElement(r.a.Fragment,{},e.children)}},p=function(e){var a=e.components,n=e.mdxType,t=e.originalType,i=e.parentName,l=function(e,a){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&-1===a.indexOf(t)&&(n[t]=e[t]);return n}(e,["components","mdxType","originalType","parentName"]),b=c(a);return r.a.createElement(b[i+"."+n]||b[n]||o[n]||t,a?Object.assign({},l,{components:a}):l)};function d(e,a){var n=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var i=n.length,c=new Array(i);c[0]=p;var l={};for(var o in a)hasOwnProperty.call(a,o)&&(l[o]=a[o]);l.originalType=e,l[b]="string"==typeof e?e:t,c[1]=l;for(var d=2;d<i;d++)c[d]=n[d];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"}}]);